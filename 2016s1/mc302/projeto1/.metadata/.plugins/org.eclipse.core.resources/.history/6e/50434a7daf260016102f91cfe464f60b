package br.unicamp.ic.mc302.reservaDeQuartos;

import java.util.ArrayList;
import java.util.HashMap;

public class ControleOcupacao {
	
	private SistemaReservas sistema;
	private ControleReservas reservas;
	private ControleQuartos quartos;
	private ControleSaida out;
	
	private HashMap<Quarto, Ocupacao> ocupacoes;
	
	public ControleOcupacao() {
		// TODO Auto-generated constructor stub
	}

	public void ocupar(Reserva r) {
		
		ArrayList<Quarto> qIDs = quartos.buscaQuartoTipo(r.tipoQuarto());
		
		Quarto vazio = null;
		
		for(Quarto q : qIDs){
			
			Ocupacao oc = ocupacoes.get(q);
			
			if(oc == null){
				vazio = q;
				break;
			}
		}
		
		if(vazio == null){
			out.println("Overbooked!\n");
			return;
		}
			
		Ocupacao ocp = new Ocupacao(vazio, r, sistema.horaDoSistema());
		ocupacoes.put(vazio, ocp);
	}
	
	
	public void desocupar(Ocupacao oc) {
		
		reservas.removerReserva(oc.reserva());
		ocupacoes.remove(oc.quarto());
	}
	
}
